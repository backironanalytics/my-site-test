mutate(ast_reb = ast+treb) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,ast_reb) %>% arrange(desc(dateGame)) %>% head(5)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(ast_reb > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
ast_reb_five <- bind_rows(ast_reb_five) %>% unnest(cols = everything()) %>% mutate(Type = "Last 5")
ast_reb_df <- bind_rows(ast_reb,ast_reb_away,ast_reb_home,ast_reb_five,ast_reb_ten)
ast_reb_df$namePlayer <- stri_trans_general(str = ast_reb_df$namePlayer, id = "Latin-ASCII")
ast_reb_df <- ast_reb_df %>% left_join(dk_astreb, by = c("namePlayer","OU")) %>% filter(!is.na(Over)) %>% rename(season_hit = test) %>%
left_join(playerdata %>% filter(typeSeason == "Regular Season", slugSeason == "2024-25") %>%
mutate(avg = ast+treb) %>% group_by(idPlayer) %>% summarize(avg = mean(avg)), by = "idPlayer")
ast_reb_df_join <- ast_reb_df  %>% mutate(Ident = ifelse(season_hit < .30 & Type == "Regular Season", 1,0)) %>%
group_by(namePlayer,idPlayer) %>% summarize(Ident = mean(Ident))
ast_reb_picks <- ast_reb_df %>% left_join(ast_reb_df_join, by = c("namePlayer","idPlayer")) %>%
filter(Ident != 0) %>% group_by(namePlayer,idPlayer, OU, Type, avg = as.character(round(avg,1))) %>%
summarize(season_hit) %>% ungroup() %>% mutate(season_hit = 1 - season_hit) %>%pivot_wider(names_from = Type, values_from = season_hit) %>% left_join(all_rosters %>% select(idPlayer,slugTeam), by = "idPlayer") %>%
left_join(teams %>% select(slugTeam,urlThumbnailTeam), by = "slugTeam") %>%
left_join(matchup %>% select(slugTeam,matchup), by = "slugTeam") %>%
relocate(urlThumbnailTeam, .after = namePlayer) %>% relocate(matchup, .after = urlThumbnailTeam) %>% select(-c(slugTeam,idPlayer))
reactable(highlight = TRUE, striped = TRUE,ast_reb_picks, columns = list(namePlayer = colDef(name = "Player",sticky = "left", width = 110),
urlThumbnailTeam = colDef(name = "Team",cell = embed_img(height = "25",width="25")),
avg = colDef(name = "Season Avg"),
OU = colDef(name = "Total Assists & Rebounds O/U",width = 110),
`Away Games` = colDef(cell = data_bars(ast_reb_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent)),
`Home Games` = colDef(cell = data_bars(ast_reb_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent)),
`Last 10` = colDef(cell = data_bars(ast_reb_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent)),
`Last 5` = colDef(cell = data_bars(ast_reb_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent)),
`Regular Season` = colDef(cell = data_bars(ast_reb_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent))),
theme = fivethirtyeight(), defaultPageSize = 20, fullWidth = TRUE) %>% add_title("Under Success Rates") %>% add_subtitle("2024/25 Regular Season")
##Steals + Blocks
stl_blk <- lapply(next_team_batch$idPlayer, function(x){
hit_rate <- seq(0.5,7.5,1)
df <- playerdata %>% filter(idPlayer == x, typeSeason == "Regular Season", slugSeason == "2024-25") %>%
mutate(stl_blk = stl+blk) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,stl_blk)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(stl_blk > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
stl_blk <- bind_rows(stl_blk) %>% unnest(cols = everything()) %>% mutate(Type = "Regular Season")
##Steals + Blocks Home Games
stl_blk_home <- lapply(next_team_batch$idPlayer, function(x){
hit_rate <- seq(0.5,7.5,1)
df <- playerdata %>% filter(idPlayer == x, typeSeason == "Regular Season", slugSeason == "2024-25", locationGame == "H") %>%
mutate(stl_blk = stl+blk) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,stl_blk)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(stl_blk > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
stl_blk_home <- bind_rows(stl_blk_home) %>% unnest(cols = everything()) %>% mutate(Type = "Home Games")
##Steals + Blocks Away Games
stl_blk_away <- lapply(next_team_batch$idPlayer, function(x){
hit_rate <- seq(0.5,7.5,1)
df <- playerdata %>% filter(idPlayer == x, typeSeason == "Regular Season", slugSeason == "2024-25", locationGame == "A") %>%
mutate(stl_blk = stl+blk) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,stl_blk)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(stl_blk > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
stl_blk_away <- bind_rows(stl_blk_away) %>% unnest(cols = everything()) %>% mutate(Type = "Away Games")
##Steals + Blocks Last 10
stl_blk_ten <- lapply(next_team_batch$idPlayer, function(x){
hit_rate <- seq(0.5,7.5,1)
df <- playerdata %>% filter(idPlayer == x, typeSeason == "Regular Season", slugSeason == "2024-25") %>%
mutate(stl_blk = stl+blk) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,stl_blk) %>% arrange(desc(dateGame)) %>% head(10)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(stl_blk > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
stl_blk_ten <- bind_rows(stl_blk_ten) %>% unnest(cols = everything()) %>% mutate(Type = "Last 10")
##Steals + Blocks Last 5
stl_blk_five <- lapply(next_team_batch$idPlayer, function(x){
hit_rate <- seq(0.5,7.5,1)
df <- playerdata %>% filter(idPlayer == x, typeSeason == "Regular Season", slugSeason == "2024-25") %>%
mutate(stl_blk = stl+blk) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,stl_blk) %>% arrange(desc(dateGame)) %>% head(5)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(stl_blk > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
stl_blk_five <- bind_rows(stl_blk_five) %>% unnest(cols = everything()) %>% mutate(Type = "Last 5")
stl_blk_df <- bind_rows(stl_blk,stl_blk_away,stl_blk_home,stl_blk_five,stl_blk_ten)
stl_blk_df$namePlayer <- stri_trans_general(str = stl_blk_df$namePlayer, id = "Latin-ASCII")
stl_blk_df <- stl_blk_df %>% left_join(dk_stlblk, by = c("namePlayer","OU")) %>% filter(!is.na(Over)) %>% rename(season_hit = test) %>%
left_join(playerdata %>% filter(typeSeason == "Regular Season", slugSeason == "2024-25") %>%
mutate(avg = stl+blk) %>% group_by(idPlayer) %>% summarize(avg = mean(avg)), by = "idPlayer")
stl_blk_df_join <- stl_blk_df  %>% mutate(Ident = ifelse(season_hit < .30 & Type == "Regular Season", 1,0)) %>%
group_by(namePlayer,idPlayer) %>% summarize(Ident = mean(Ident))
stl_blk_picks <- stl_blk_df %>% left_join(stl_blk_df_join, by = c("namePlayer","idPlayer")) %>%
filter(Ident != 0) %>% group_by(namePlayer,idPlayer, OU, Type, avg = as.character(round(avg,1))) %>%
summarize(season_hit) %>% ungroup() %>% mutate(season_hit = 1 - season_hit) %>%pivot_wider(names_from = Type, values_from = season_hit) %>% left_join(all_rosters %>% select(idPlayer,slugTeam), by = "idPlayer") %>%
left_join(teams %>% select(slugTeam,urlThumbnailTeam), by = "slugTeam") %>%
left_join(matchup %>% select(slugTeam,matchup), by = "slugTeam") %>%
relocate(urlThumbnailTeam, .after = namePlayer) %>% relocate(matchup, .after = urlThumbnailTeam) %>% select(-c(slugTeam,idPlayer))
reactable(highlight = TRUE, striped = TRUE,stl_blk_picks, columns = list(namePlayer = colDef(name = "Player",sticky = "left", width = 110),
urlThumbnailTeam = colDef(name = "Team",cell = embed_img(height = "25",width="25")),
avg = colDef(name = "Season Avg"),
OU = colDef(name = "Total Steals & Blocks O/U",width = 110),
`Away Games` = colDef(cell = data_bars(stl_blk_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent)),
`Home Games` = colDef(cell = data_bars(stl_blk_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent)),
`Last 10` = colDef(cell = data_bars(stl_blk_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent)),
`Last 5` = colDef(cell = data_bars(stl_blk_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent)),
`Regular Season` = colDef(cell = data_bars(stl_blk_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent))),
theme = fivethirtyeight(), defaultPageSize = 20, fullWidth = TRUE) %>% add_title("Under Success Rates") %>% add_subtitle("2024/25 Regular Season")
stl_blk_df
##Three Pointers Made
fg3m <- lapply(next_team_batch$idPlayer, function(x){
hit_rate <- seq(0.5,6.5,1)
df <- playerdata %>% filter(idPlayer == x, typeSeason == "Regular Season", slugSeason == "2024-25") %>%
mutate(pts_reb_ast = pts+treb+ast) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,fg3m)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(fg3m > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
fg3m <- bind_rows(fg3m) %>% unnest(cols = everything()) %>% mutate(Type = "Regular Season")
##Three Pointers Made Home Games
fg3m_home <- lapply(next_team_batch$idPlayer, function(x){
hit_rate <- seq(0.5,6.5,1)
df <- playerdata %>% filter(idPlayer == x, typeSeason == "Regular Season", slugSeason == "2024-25", locationGame == "H") %>%
mutate(pts_reb_ast = pts+treb+ast) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,fg3m)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(fg3m > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
fg3m_home <- bind_rows(fg3m_home) %>% unnest(cols = everything()) %>% mutate(Type = "Home Games")
##Three Pointers Made Away Games
fg3m_away <- lapply(next_team_batch$idPlayer, function(x){
hit_rate <- seq(0.5,6.5,1)
df <- playerdata %>% filter(idPlayer == x, typeSeason == "Regular Season", slugSeason == "2024-25", locationGame == "A") %>%
mutate(pts_reb_ast = pts+treb+ast) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,fg3m)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(fg3m > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
fg3m_away <- bind_rows(fg3m_away) %>% unnest(cols = everything()) %>% mutate(Type = "Away Games")
##Three Pointers Made Last 10
fg3m_ten <- lapply(next_team_batch$idPlayer, function(x){
hit_rate <- seq(0.5,6.5,1)
df <- playerdata %>% filter(idPlayer == x, typeSeason == "Regular Season", slugSeason == "2024-25") %>%
mutate(pts_reb_ast = pts+treb+ast) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,fg3m) %>% arrange(desc(dateGame)) %>% head(10)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(fg3m > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
fg3m_ten <- bind_rows(fg3m_ten) %>% unnest(cols = everything()) %>% mutate(Type = "Last 10")
##Three Pointers Made Last 5
fg3m_five <- lapply(next_team_batch$idPlayer, function(x){
hit_rate <- seq(0.5,6.5,1)
df <- playerdata %>% filter(idPlayer == x, typeSeason == "Regular Season", slugSeason == "2024-25") %>%
mutate(pts_reb_ast = pts+treb+ast) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,fg3m) %>% arrange(desc(dateGame)) %>% head(5)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(fg3m > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
fg3m_five <- bind_rows(fg3m_five) %>% unnest(cols = everything()) %>% mutate(Type = "Last 5")
fg3m_df <- bind_rows(fg3m,fg3m_away,fg3m_home,fg3m_five,fg3m_ten)
fg3m_df$namePlayer <- stri_trans_general(str = fg3m_df$namePlayer, id = "Latin-ASCII")
fg3m_df <- fg3m_df %>% left_join(dk_fg3m, by = c("namePlayer","OU")) %>% filter(!is.na(Over)) %>% rename(season_hit = test) %>%
left_join(playerdata %>% filter(typeSeason == "Regular Season", slugSeason == "2024-25") %>% group_by(idPlayer) %>% summarize(avg = mean(fg3m)), by = "idPlayer")
fg3m_df_join <- fg3m_df  %>% mutate(Ident = ifelse(season_hit < .30 & Type == "Regular Season", 1,0)) %>%
group_by(namePlayer,idPlayer) %>% summarize(Ident = mean(Ident))
fg3m_picks <- fg3m_df %>% left_join(fg3m_df_join, by = c("namePlayer","idPlayer")) %>%
filter(Ident != 0) %>% group_by(namePlayer,idPlayer, OU, Type, avg = as.character(round(avg,1))) %>%
summarize(season_hit) %>% ungroup() %>% mutate(season_hit = 1 - season_hit) %>%pivot_wider(names_from = Type, values_from = season_hit) %>% left_join(all_rosters %>% select(idPlayer,slugTeam), by = "idPlayer") %>%
left_join(teams %>% select(slugTeam,urlThumbnailTeam), by = "slugTeam") %>%
left_join(matchup %>% select(slugTeam,matchup), by = "slugTeam") %>%
relocate(urlThumbnailTeam, .after = namePlayer) %>% relocate(matchup, .after = urlThumbnailTeam) %>% select(-c(slugTeam,idPlayer))
reactable(highlight = TRUE, striped = TRUE,fg3m_picks, columns = list(namePlayer = colDef(name = "Player",sticky = "left", width = 110),
urlThumbnailTeam = colDef(name = "Team",cell = embed_img(height = "25",width="25")),
avg = colDef(name = "Season Avg"),
OU = colDef(name = "Total Threes Made O/U",width = 110),
`Away Games` = colDef(cell = data_bars(fg3m_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent)),
`Home Games` = colDef(cell = data_bars(fg3m_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent)),
`Last 10` = colDef(cell = data_bars(fg3m_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent)),
`Last 5` = colDef(cell = data_bars(fg3m_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent)),
`Regular Season` = colDef(cell = data_bars(fg3m_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent))),
theme = fivethirtyeight(), defaultPageSize = 20, fullWidth = TRUE) %>% add_title("Under Success Rates") %>% add_subtitle("2024/25 Regular Season")
##Blocks
blk <- lapply(next_team_batch$idPlayer, function(x){
hit_rate <- seq(0.5,5.5,1)
df <- playerdata %>% filter(idPlayer == x, typeSeason == "Regular Season", slugSeason == "2024-25") %>%
mutate(pts_reb_ast = pts+treb+ast) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,blk)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(blk > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
blk <- bind_rows(blk) %>% unnest(cols = everything()) %>% mutate(Type = "Regular Season")
##Blocks Home Games
blk_home <- lapply(next_team_batch$idPlayer, function(x){
hit_rate <- seq(0.5,5.5,1)
df <- playerdata %>% filter(idPlayer == x, typeSeason == "Regular Season", slugSeason == "2024-25", locationGame == "H") %>%
mutate(pts_reb_ast = pts+treb+ast) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,blk)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(blk > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
blk_home <- bind_rows(blk_home) %>% unnest(cols = everything()) %>% mutate(Type = "Home Games")
##Blocks Away Games
blk_away <- lapply(next_team_batch$idPlayer, function(x){
hit_rate <- seq(0.5,5.5,1)
df <- playerdata %>% filter(idPlayer == x, typeSeason == "Regular Season", slugSeason == "2024-25", locationGame == "A") %>%
mutate(pts_reb_ast = pts+treb+ast) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,blk)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(blk > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
blk_away <- bind_rows(blk_home) %>% unnest(cols = everything()) %>% mutate(Type = "Away Games")
##Blocks Last 10
blk_ten <- lapply(next_team_batch$idPlayer, function(x){
hit_rate <- seq(0.5,5.5,1)
df <- playerdata %>% filter(idPlayer == x, typeSeason == "Regular Season", slugSeason == "2024-25") %>%
mutate(pts_reb_ast = pts+treb+ast) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,blk) %>% arrange(desc(dateGame)) %>% head(10)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(blk > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
blk_ten <- bind_rows(blk_ten) %>% unnest(cols = everything()) %>% mutate(Type = "Last 10")
##Blocks Last 5
blk_five <- lapply(next_team_batch$idPlayer, function(x){
hit_rate <- seq(0.5,5.5,1)
df <- playerdata %>% filter(idPlayer == x, typeSeason == "Regular Season", slugSeason == "2024-25") %>%
mutate(pts_reb_ast = pts+treb+ast) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,blk) %>% arrange(desc(dateGame)) %>% head(5)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(blk > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
blk_five <- bind_rows(blk_five) %>% unnest(cols = everything()) %>% mutate(Type = "Last 5")
blk_df <- bind_rows(blk,blk_away,blk_home,blk_five,blk_ten)
blk_df$namePlayer <- stri_trans_general(str = blk_df$namePlayer, id = "Latin-ASCII")
blk_df <- blk_df %>% left_join(dk_blk, by = c("namePlayer","OU")) %>% filter(!is.na(Over)) %>% rename(season_hit = test) %>%
left_join(playerdata %>% filter(typeSeason == "Regular Season", slugSeason == "2024-25")  %>% group_by(idPlayer) %>% summarize(avg = mean(blk)), by = "idPlayer")
blk_df_join <- blk_df  %>% mutate(Ident = ifelse(season_hit < .30 & Type == "Regular Season", 1,0)) %>%
group_by(namePlayer,idPlayer) %>% summarize(Ident = mean(Ident))
blk_picks <- blk_df %>% left_join(blk_df_join, by = c("namePlayer","idPlayer")) %>%
filter(Ident != 0) %>% group_by(namePlayer,idPlayer, OU, Type, avg = as.character(round(avg,1))) %>%
summarize(season_hit) %>% ungroup() %>% mutate(season_hit = 1 - season_hit) %>%pivot_wider(names_from = Type, values_from = season_hit) %>% left_join(all_rosters %>% select(idPlayer,slugTeam), by = "idPlayer") %>%
left_join(teams %>% select(slugTeam,urlThumbnailTeam), by = "slugTeam") %>%
left_join(matchup %>% select(slugTeam,matchup), by = "slugTeam") %>%
relocate(urlThumbnailTeam, .after = namePlayer) %>% relocate(matchup, .after = urlThumbnailTeam) %>% select(-c(slugTeam,idPlayer))
reactable(highlight = TRUE, striped = TRUE,blk_picks, columns = list(namePlayer = colDef(name = "Player",sticky = "left", width = 110),
urlThumbnailTeam = colDef(name = "Team",cell = embed_img(height = "25",width="25")),
avg = colDef(name = "Season Avg"),
OU = colDef(name = "Total Blocks O/U",width = 110),
`Away Games` = colDef(cell = data_bars(blk_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent)),
`Home Games` = colDef(cell = data_bars(blk_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent)),
`Last 10` = colDef(cell = data_bars(blk_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent)),
`Last 5` = colDef(cell = data_bars(blk_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent)),
`Regular Season` = colDef(cell = data_bars(blk_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent))),
theme = fivethirtyeight(), defaultPageSize = 20, fullWidth = TRUE) %>% add_title("Under Success Rates") %>% add_subtitle("2024/25 Regular Season")
##Assists
ast <- lapply(next_team_batch$idPlayer, function(x){
hit_rate <- seq(0.5,13.5,1)
df <- playerdata %>% filter(idPlayer == x, typeSeason == "Regular Season", slugSeason == "2024-25") %>%
mutate(ast_reb_ast = ast+treb+ast) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,ast)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(ast > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
ast <- bind_rows(ast) %>% unnest(cols = everything()) %>% mutate(Type = "Regular Season")
##Assists Home Games
ast_home <- lapply(next_team_batch$idPlayer, function(x){
hit_rate <- seq(0.5,13.5,1)
df <- playerdata %>% filter(idPlayer == x, typeSeason == "Regular Season", slugSeason == "2024-25", locationGame == "H") %>%
mutate(ast_reb_ast = ast+treb+ast) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,ast)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(ast > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
ast_home <- bind_rows(ast_home) %>% unnest(cols = everything()) %>% mutate(Type = "Home Games")
##Assists Away Games
ast_away <- lapply(next_team_batch$idPlayer, function(x){
hit_rate <- seq(0.5,13.5,1)
df <- playerdata %>% filter(idPlayer == x, typeSeason == "Regular Season", slugSeason == "2024-25", locationGame == "A") %>%
mutate(ast_reb_ast = ast+treb+ast) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,ast)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(ast > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
ast_away <- bind_rows(ast_home) %>% unnest(cols = everything()) %>% mutate(Type = "Away Games")
##Assists Last 10
ast_ten <- lapply(next_team_batch$idPlayer, function(x){
hit_rate <- seq(0.5,13.5,1)
df <- playerdata %>% filter(idPlayer == x, typeSeason == "Regular Season", slugSeason == "2024-25") %>%
mutate(ast_reb_ast = ast+treb+ast) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,ast) %>% arrange(desc(dateGame)) %>% head(10)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(ast > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
ast_ten <- bind_rows(ast_ten) %>% unnest(cols = everything()) %>% mutate(Type = "Last 10")
##Assists Last 5
ast_five <- lapply(next_team_batch$idPlayer, function(x){
hit_rate <- seq(0.5,13.5,1)
df <- playerdata %>% filter(idPlayer == x, typeSeason == "Regular Season", slugSeason == "2024-25") %>%
mutate(ast_reb_ast = ast+treb+ast) %>% select(namePlayer,idPlayer,slugTeam,dateGame,locationGame,ast) %>% arrange(desc(dateGame)) %>% head(5)
hit_rate_above <- lapply(hit_rate, function(x){
df %>% mutate(test = mean(ast > x), OU = x) %>% group_by(namePlayer, idPlayer, OU) %>% summarize(test = min(test), .groups = 'drop') %>%
ungroup()
})
hit_rate_above
})
ast_five <- bind_rows(ast_five) %>% unnest(cols = everything()) %>% mutate(Type = "Last 5")
ast_df <- bind_rows(ast,ast_away,ast_home,ast_five,ast_ten)
ast_df$namePlayer <- stri_trans_general(str = ast_df$namePlayer, id = "Latin-ASCII")
ast_df <- ast_df %>% left_join(dk_ast, by = c("namePlayer","OU")) %>% filter(!is.na(Over)) %>% rename(season_hit = test) %>%
left_join(playerdata %>% filter(typeSeason == "Regular Season", slugSeason == "2024-25")  %>% group_by(idPlayer) %>% summarize(avg = mean(ast)), by = "idPlayer")
ast_df_join <- ast_df  %>% mutate(Ident = ifelse(season_hit < .30 & Type == "Regular Season", 1,0)) %>%
group_by(namePlayer,idPlayer) %>% summarize(Ident = mean(Ident))
ast_picks <- ast_df %>% left_join(ast_df_join, by = c("namePlayer","idPlayer")) %>%
filter(Ident != 0) %>% group_by(namePlayer,idPlayer, OU, Type, avg = as.character(round(avg,1))) %>%
summarize(season_hit) %>% ungroup() %>% mutate(season_hit = 1 - season_hit) %>%
pivot_wider(names_from = Type, values_from = season_hit) %>% left_join(all_rosters %>% select(idPlayer,slugTeam), by = "idPlayer") %>%
left_join(teams %>% select(slugTeam,urlThumbnailTeam), by = "slugTeam") %>%
left_join(matchup %>% select(slugTeam,matchup), by = "slugTeam") %>%
relocate(urlThumbnailTeam, .after = namePlayer) %>% relocate(matchup, .after = urlThumbnailTeam) %>% select(-c(slugTeam,idPlayer))
reactable(highlight = TRUE, striped = TRUE,ast_picks, columns = list(namePlayer = colDef(name = "Player",sticky = "left", width = 110),
urlThumbnailTeam = colDef(name = "Team",cell = embed_img(height = "25",width="25")),
avg= colDef(name = "Season Avg"),
OU = colDef(name = "Total Assists O/U",width = 110),
`Away Games` = colDef(cell = data_bars(ast_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent)),
`Home Games` = colDef(cell = data_bars(ast_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent)),
`Last 10` = colDef(cell = data_bars(ast_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent)),
`Last 5` = colDef(cell = data_bars(ast_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent)),
`Regular Season` = colDef(cell = data_bars(ast_picks,
fill_color = color_set,
background = '#F1F1F1',
min_value = 0,
max_value = 1,
text_position = 'outside-end',
number_fmt = scales::percent))),
theme = fivethirtyeight(), defaultPageSize = 20, fullWidth = TRUE) %>% add_title("Under Success Rates") %>% add_subtitle("2024/25 Regular Season")
